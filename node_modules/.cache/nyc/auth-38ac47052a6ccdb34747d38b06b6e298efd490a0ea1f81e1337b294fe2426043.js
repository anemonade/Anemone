function cov_36j8t0lxd(){var path="C:\\Users\\miarm\\Documents\\projects\\Anemone\\src\\main\\server\\auth.js";var hash="6e4f09c73401f0584e24165a34b72a3b725e1ea7";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\miarm\\Documents\\projects\\Anemone\\src\\main\\server\\auth.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:35}},"1":{start:{line:3,column:17},end:{line:3,column:36}},"2":{start:{line:7,column:22},end:{line:7,column:32}},"3":{start:{line:9,column:21},end:{line:9,column:43}},"4":{start:{line:11,column:22},end:{line:11,column:64}},"5":{start:{line:12,column:18},end:{line:12,column:47}},"6":{start:{line:14,column:19},end:{line:14,column:39}},"7":{start:{line:16,column:4},end:{line:20,column:7}},"8":{start:{line:22,column:4},end:{line:22,column:33}},"9":{start:{line:24,column:4},end:{line:24,column:19}},"10":{start:{line:29,column:21},end:{line:29,column:41}},"11":{start:{line:30,column:16},end:{line:30,column:65}},"12":{start:{line:30,column:39},end:{line:30,column:64}},"13":{start:{line:33,column:4},end:{line:37,column:5}},"14":{start:{line:34,column:8},end:{line:36,column:10}},"15":{start:{line:40,column:4},end:{line:44,column:5}},"16":{start:{line:41,column:8},end:{line:43,column:10}},"17":{start:{line:46,column:4},end:{line:49,column:6}},"18":{start:{line:52,column:0},end:{line:52,column:49}}},fnMap:{"0":{name:"generateToken",decl:{start:{line:6,column:9},end:{line:6,column:22}},loc:{start:{line:6,column:33},end:{line:25,column:1}},line:6},"1":{name:"tokenIsValid",decl:{start:{line:28,column:9},end:{line:28,column:21}},loc:{start:{line:28,column:31},end:{line:50,column:1}},line:28},"2":{name:"(anonymous_2)",decl:{start:{line:30,column:30},end:{line:30,column:31}},loc:{start:{line:30,column:39},end:{line:30,column:64}},line:30}},branchMap:{"0":{loc:{start:{line:33,column:4},end:{line:37,column:5}},type:"if",locations:[{start:{line:33,column:4},end:{line:37,column:5}},{start:{line:33,column:4},end:{line:37,column:5}}],line:33},"1":{loc:{start:{line:40,column:4},end:{line:44,column:5}},type:"if",locations:[{start:{line:40,column:4},end:{line:44,column:5}},{start:{line:40,column:4},end:{line:44,column:5}}],line:40}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6e4f09c73401f0584e24165a34b72a3b725e1ea7"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_36j8t0lxd=function(){return actualCoverage;};}return actualCoverage;}cov_36j8t0lxd();const other=(cov_36j8t0lxd().s[0]++,require("./other.js")),ONE_DAY_MS=(cov_36j8t0lxd().s[1]++,24*60*60*1000);// Generate a unique token wtih expiration time and adds it to the valid tokens list
function generateToken(username){cov_36j8t0lxd().f[0]++;const timestamp=(cov_36j8t0lxd().s[2]++,Date.now()),// Expiration time of 1 day from now
expiration=(cov_36j8t0lxd().s[3]++,timestamp+ONE_DAY_MS),// Generates a base-36 string and then extracts 16 digits
tokenString=(cov_36j8t0lxd().s[4]++,Math.random().toString(36).substring(2,17)),tokenId=(cov_36j8t0lxd().s[5]++,`${timestamp}_${tokenString}`),jsonData=(cov_36j8t0lxd().s[6]++,other.getTokenData());cov_36j8t0lxd().s[7]++;jsonData.push({tokenId,username,expiration});cov_36j8t0lxd().s[8]++;other.setTokenData(jsonData);cov_36j8t0lxd().s[9]++;return tokenId;}// Authenticates that a token is valid, returns a boolean value + corresponding user
function tokenIsValid(tokenId){cov_36j8t0lxd().f[1]++;const jsonData=(cov_36j8t0lxd().s[10]++,other.getTokenData()),token=(cov_36j8t0lxd().s[11]++,jsonData.find(token=>{cov_36j8t0lxd().f[2]++;cov_36j8t0lxd().s[12]++;return token.tokenId===tokenId;}));// Could not find token
cov_36j8t0lxd().s[13]++;if(token===undefined){cov_36j8t0lxd().b[0][0]++;cov_36j8t0lxd().s[14]++;return{valid:false};}else{cov_36j8t0lxd().b[0][1]++;}// Token has expired
cov_36j8t0lxd().s[15]++;if(token.expiration<Date.now()){cov_36j8t0lxd().b[1][0]++;cov_36j8t0lxd().s[16]++;return{valid:false};}else{cov_36j8t0lxd().b[1][1]++;}cov_36j8t0lxd().s[17]++;return{valid:true,username:token.username};}cov_36j8t0lxd().s[18]++;module.exports={generateToken,tokenIsValid};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMzZqOHQwbHhkIiwiYWN0dWFsQ292ZXJhZ2UiLCJvdGhlciIsInMiLCJyZXF1aXJlIiwiT05FX0RBWV9NUyIsImdlbmVyYXRlVG9rZW4iLCJ1c2VybmFtZSIsImYiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiZXhwaXJhdGlvbiIsInRva2VuU3RyaW5nIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwidG9rZW5JZCIsImpzb25EYXRhIiwiZ2V0VG9rZW5EYXRhIiwicHVzaCIsInNldFRva2VuRGF0YSIsInRva2VuSXNWYWxpZCIsInRva2VuIiwiZmluZCIsInVuZGVmaW5lZCIsImIiLCJ2YWxpZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJhdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG90aGVyID0gcmVxdWlyZShcIi4vb3RoZXIuanNcIiksXHJcblxyXG4gICAgT05FX0RBWV9NUyA9IDI0ICogNjAgKiA2MCAqIDEwMDA7XHJcblxyXG4vLyBHZW5lcmF0ZSBhIHVuaXF1ZSB0b2tlbiB3dGloIGV4cGlyYXRpb24gdGltZSBhbmQgYWRkcyBpdCB0byB0aGUgdmFsaWQgdG9rZW5zIGxpc3RcclxuZnVuY3Rpb24gZ2VuZXJhdGVUb2tlbih1c2VybmFtZSkge1xyXG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKSxcclxuICAgICAgICAvLyBFeHBpcmF0aW9uIHRpbWUgb2YgMSBkYXkgZnJvbSBub3dcclxuICAgICAgICBleHBpcmF0aW9uID0gdGltZXN0YW1wICsgT05FX0RBWV9NUyxcclxuICAgICAgICAvLyBHZW5lcmF0ZXMgYSBiYXNlLTM2IHN0cmluZyBhbmQgdGhlbiBleHRyYWN0cyAxNiBkaWdpdHNcclxuICAgICAgICB0b2tlblN0cmluZyA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLDE3KSxcclxuICAgICAgICB0b2tlbklkID0gYCR7dGltZXN0YW1wfV8ke3Rva2VuU3RyaW5nfWAsXHJcbiAgICBcclxuICAgICAgICBqc29uRGF0YSA9IG90aGVyLmdldFRva2VuRGF0YSgpO1xyXG5cclxuICAgIGpzb25EYXRhLnB1c2goe1xyXG4gICAgICAgIHRva2VuSWQsXHJcbiAgICAgICAgdXNlcm5hbWUsXHJcbiAgICAgICAgZXhwaXJhdGlvblxyXG4gICAgfSk7XHJcblxyXG4gICAgb3RoZXIuc2V0VG9rZW5EYXRhKGpzb25EYXRhKTtcclxuXHJcbiAgICByZXR1cm4gdG9rZW5JZDtcclxufVxyXG5cclxuLy8gQXV0aGVudGljYXRlcyB0aGF0IGEgdG9rZW4gaXMgdmFsaWQsIHJldHVybnMgYSBib29sZWFuIHZhbHVlICsgY29ycmVzcG9uZGluZyB1c2VyXHJcbmZ1bmN0aW9uIHRva2VuSXNWYWxpZCh0b2tlbklkKSB7XHJcbiAgICBjb25zdCBqc29uRGF0YSA9IG90aGVyLmdldFRva2VuRGF0YSgpLFxyXG4gICAgICAgIHRva2VuID0ganNvbkRhdGEuZmluZCh0b2tlbiA9PiB0b2tlbi50b2tlbklkID09PSB0b2tlbklkKTtcclxuXHJcbiAgICAvLyBDb3VsZCBub3QgZmluZCB0b2tlblxyXG4gICAgaWYgKHRva2VuID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2YWxpZDogZmFsc2VcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRva2VuIGhhcyBleHBpcmVkXHJcbiAgICBpZiAodG9rZW4uZXhwaXJhdGlvbiA8IERhdGUubm93KCkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2YWxpZDogZmFsc2VcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdmFsaWQ6IHRydWUsXHJcbiAgICAgICAgdXNlcm5hbWU6IHRva2VuLnVzZXJuYW1lXHJcbiAgICB9O1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHsgZ2VuZXJhdGVUb2tlbiwgdG9rZW5Jc1ZhbGlkIH07Il0sIm1hcHBpbmdzIjoieW1GQWVZO0FBQUFBLGFBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsYUFBQSxHQWZaLEtBQU0sQ0FBQUUsS0FBSyxFQUFBRixhQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLFlBQVksQ0FBQyxFQUUvQkMsVUFBVSxFQUFBTCxhQUFBLEdBQUFHLENBQUEsTUFBRyxFQUFFLENBQUcsRUFBRSxDQUFHLEVBQUUsQ0FBRyxJQUFJLEVBRXBDO0FBQ0EsUUFBUyxDQUFBRyxhQUFhQSxDQUFDQyxRQUFRLENBQUUsQ0FBQVAsYUFBQSxHQUFBUSxDQUFBLE1BQzdCLEtBQU0sQ0FBQUMsU0FBUyxFQUFBVCxhQUFBLEdBQUFHLENBQUEsTUFBR08sSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQyxFQUN4QjtBQUNBQyxVQUFVLEVBQUFaLGFBQUEsR0FBQUcsQ0FBQSxNQUFHTSxTQUFTLENBQUdKLFVBQVUsRUFDbkM7QUFDQVEsV0FBVyxFQUFBYixhQUFBLEdBQUFHLENBQUEsTUFBR1csSUFBSSxDQUFDQyxNQUFNLENBQUMsQ0FBQyxDQUFDQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUNDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQ3hEQyxPQUFPLEVBQUFsQixhQUFBLEdBQUFHLENBQUEsTUFBSSxHQUFFTSxTQUFVLElBQUdJLFdBQVksRUFBQyxFQUV2Q00sUUFBUSxFQUFBbkIsYUFBQSxHQUFBRyxDQUFBLE1BQUdELEtBQUssQ0FBQ2tCLFlBQVksQ0FBQyxDQUFDLEVBQUNwQixhQUFBLEdBQUFHLENBQUEsTUFFcENnQixRQUFRLENBQUNFLElBQUksQ0FBQyxDQUNWSCxPQUFPLENBQ1BYLFFBQVEsQ0FDUkssVUFDSixDQUFDLENBQUMsQ0FBQ1osYUFBQSxHQUFBRyxDQUFBLE1BRUhELEtBQUssQ0FBQ29CLFlBQVksQ0FBQ0gsUUFBUSxDQUFDLENBQUNuQixhQUFBLEdBQUFHLENBQUEsTUFFN0IsTUFBTyxDQUFBZSxPQUFPLENBQ2xCLENBRUE7QUFDQSxRQUFTLENBQUFLLFlBQVlBLENBQUNMLE9BQU8sQ0FBRSxDQUFBbEIsYUFBQSxHQUFBUSxDQUFBLE1BQzNCLEtBQU0sQ0FBQVcsUUFBUSxFQUFBbkIsYUFBQSxHQUFBRyxDQUFBLE9BQUdELEtBQUssQ0FBQ2tCLFlBQVksQ0FBQyxDQUFDLEVBQ2pDSSxLQUFLLEVBQUF4QixhQUFBLEdBQUFHLENBQUEsT0FBR2dCLFFBQVEsQ0FBQ00sSUFBSSxDQUFDRCxLQUFLLEVBQUksQ0FBQXhCLGFBQUEsR0FBQVEsQ0FBQSxNQUFBUixhQUFBLEdBQUFHLENBQUEsY0FBQXFCLEtBQUssQ0FBQ04sT0FBTyxHQUFLQSxPQUFPLENBQUQsQ0FBQyxDQUFDLEVBRTdEO0FBQUFsQixhQUFBLEdBQUFHLENBQUEsT0FDQSxHQUFJcUIsS0FBSyxHQUFLRSxTQUFTLENBQUUsQ0FBQTFCLGFBQUEsR0FBQTJCLENBQUEsU0FBQTNCLGFBQUEsR0FBQUcsQ0FBQSxPQUNyQixNQUFPLENBQ0h5QixLQUFLLENBQUUsS0FDWCxDQUFDLENBQ0wsQ0FBQyxLQUFBNUIsYUFBQSxHQUFBMkIsQ0FBQSxVQUVEO0FBQUEzQixhQUFBLEdBQUFHLENBQUEsT0FDQSxHQUFJcUIsS0FBSyxDQUFDWixVQUFVLENBQUdGLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUMsQ0FBRSxDQUFBWCxhQUFBLEdBQUEyQixDQUFBLFNBQUEzQixhQUFBLEdBQUFHLENBQUEsT0FDL0IsTUFBTyxDQUNIeUIsS0FBSyxDQUFFLEtBQ1gsQ0FBQyxDQUNMLENBQUMsS0FBQTVCLGFBQUEsR0FBQTJCLENBQUEsVUFBQTNCLGFBQUEsR0FBQUcsQ0FBQSxPQUVELE1BQU8sQ0FDSHlCLEtBQUssQ0FBRSxJQUFJLENBQ1hyQixRQUFRLENBQUVpQixLQUFLLENBQUNqQixRQUNwQixDQUFDLENBQ0wsQ0FBQ1AsYUFBQSxHQUFBRyxDQUFBLE9BRUQwQixNQUFNLENBQUNDLE9BQU8sQ0FBRyxDQUFFeEIsYUFBYSxDQUFFaUIsWUFBYSxDQUFDIiwiaWdub3JlTGlzdCI6W119