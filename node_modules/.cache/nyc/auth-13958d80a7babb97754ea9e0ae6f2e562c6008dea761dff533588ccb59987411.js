function cov_n3rxzid55(){var path="C:\\Users\\Ronald\\Desktop\\UNSW\\Y2T1\\SENG2021\\Anemone\\src\\main\\server\\auth.js";var hash="c3b8848bffaf0735abe20bf2d06fc54c6ff6484e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Ronald\\Desktop\\UNSW\\Y2T1\\SENG2021\\Anemone\\src\\main\\server\\auth.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:35}},"1":{start:{line:3,column:19},end:{line:3,column:38}},"2":{start:{line:7,column:22},end:{line:7,column:32}},"3":{start:{line:9,column:23},end:{line:9,column:45}},"4":{start:{line:11,column:24},end:{line:11,column:67}},"5":{start:{line:12,column:20},end:{line:12,column:49}},"6":{start:{line:14,column:21},end:{line:14,column:35}},"7":{start:{line:16,column:4},end:{line:20,column:6}},"8":{start:{line:22,column:4},end:{line:22,column:27}},"9":{start:{line:24,column:4},end:{line:24,column:19}},"10":{start:{line:29,column:21},end:{line:29,column:35}},"11":{start:{line:30,column:18},end:{line:30,column:67}},"12":{start:{line:30,column:41},end:{line:30,column:66}},"13":{start:{line:33,column:4},end:{line:37,column:5}},"14":{start:{line:34,column:8},end:{line:36,column:10}},"15":{start:{line:40,column:4},end:{line:44,column:5}},"16":{start:{line:41,column:8},end:{line:43,column:9}},"17":{start:{line:46,column:4},end:{line:49,column:5}},"18":{start:{line:52,column:0},end:{line:52,column:49}}},fnMap:{"0":{name:"generateToken",decl:{start:{line:6,column:9},end:{line:6,column:22}},loc:{start:{line:6,column:33},end:{line:25,column:1}},line:6},"1":{name:"tokenIsValid",decl:{start:{line:28,column:9},end:{line:28,column:21}},loc:{start:{line:28,column:31},end:{line:50,column:1}},line:28},"2":{name:"(anonymous_2)",decl:{start:{line:30,column:32},end:{line:30,column:33}},loc:{start:{line:30,column:41},end:{line:30,column:66}},line:30}},branchMap:{"0":{loc:{start:{line:33,column:4},end:{line:37,column:5}},type:"if",locations:[{start:{line:33,column:4},end:{line:37,column:5}},{start:{line:33,column:4},end:{line:37,column:5}}],line:33},"1":{loc:{start:{line:40,column:4},end:{line:44,column:5}},type:"if",locations:[{start:{line:40,column:4},end:{line:44,column:5}},{start:{line:40,column:4},end:{line:44,column:5}}],line:40}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c3b8848bffaf0735abe20bf2d06fc54c6ff6484e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_n3rxzid55=function(){return actualCoverage;};}return actualCoverage;}cov_n3rxzid55();const other=(cov_n3rxzid55().s[0]++,require("./other.js"));const ONE_DAY_MS=(cov_n3rxzid55().s[1]++,24*60*60*1000);// Generate a unique token wtih expiration time and adds it to the valid tokens list
function generateToken(username){cov_n3rxzid55().f[0]++;const timestamp=(cov_n3rxzid55().s[2]++,Date.now());// Expiration time of 1 day from now
const expiration=(cov_n3rxzid55().s[3]++,timestamp+ONE_DAY_MS);// Generates a base-36 string and then extracts 16 digits
const tokenString=(cov_n3rxzid55().s[4]++,Math.random().toString(36).subsbtring(2,17));const tokenId=(cov_n3rxzid55().s[5]++,`${timestamp}_${tokenString}`);const jsonData=(cov_n3rxzid55().s[6]++,getTokenData());cov_n3rxzid55().s[7]++;jsonData.push({tokenId:tokenId,username:username,expiration:expiration});cov_n3rxzid55().s[8]++;setTokenData(jsonData);cov_n3rxzid55().s[9]++;return tokenId;}// Authenticates that a token is valid, returns a boolean value + corresponding user
function tokenIsValid(tokenId){cov_n3rxzid55().f[1]++;const jsonData=(cov_n3rxzid55().s[10]++,getTokenData());const token=(cov_n3rxzid55().s[11]++,jsonData.find(token=>{cov_n3rxzid55().f[2]++;cov_n3rxzid55().s[12]++;return token.tokenId===tokenId;}));// Could not find token
cov_n3rxzid55().s[13]++;if(token===undefined){cov_n3rxzid55().b[0][0]++;cov_n3rxzid55().s[14]++;return{valid:false};}else{cov_n3rxzid55().b[0][1]++;}// Token has expired
cov_n3rxzid55().s[15]++;if(token.expiration<Date.now()){cov_n3rxzid55().b[1][0]++;cov_n3rxzid55().s[16]++;return{valid:false};}else{cov_n3rxzid55().b[1][1]++;}cov_n3rxzid55().s[17]++;return{valid:true,username:token.userename};}cov_n3rxzid55().s[18]++;module.exports={generateToken,tokenIsValid};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfbjNyeHppZDU1IiwiYWN0dWFsQ292ZXJhZ2UiLCJvdGhlciIsInMiLCJyZXF1aXJlIiwiT05FX0RBWV9NUyIsImdlbmVyYXRlVG9rZW4iLCJ1c2VybmFtZSIsImYiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiZXhwaXJhdGlvbiIsInRva2VuU3RyaW5nIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic2J0cmluZyIsInRva2VuSWQiLCJqc29uRGF0YSIsImdldFRva2VuRGF0YSIsInB1c2giLCJzZXRUb2tlbkRhdGEiLCJ0b2tlbklzVmFsaWQiLCJ0b2tlbiIsImZpbmQiLCJ1bmRlZmluZWQiLCJiIiwidmFsaWQiLCJ1c2VyZW5hbWUiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiYXV0aC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBvdGhlciA9IHJlcXVpcmUoXCIuL290aGVyLmpzXCIpO1xyXG5cclxuY29uc3QgT05FX0RBWV9NUyA9IDI0ICogNjAgKiA2MCAqIDEwMDA7XHJcblxyXG4vLyBHZW5lcmF0ZSBhIHVuaXF1ZSB0b2tlbiB3dGloIGV4cGlyYXRpb24gdGltZSBhbmQgYWRkcyBpdCB0byB0aGUgdmFsaWQgdG9rZW5zIGxpc3RcclxuZnVuY3Rpb24gZ2VuZXJhdGVUb2tlbih1c2VybmFtZSkge1xyXG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKTtcclxuICAgIC8vIEV4cGlyYXRpb24gdGltZSBvZiAxIGRheSBmcm9tIG5vd1xyXG4gICAgY29uc3QgZXhwaXJhdGlvbiA9IHRpbWVzdGFtcCArIE9ORV9EQVlfTVM7XHJcbiAgICAvLyBHZW5lcmF0ZXMgYSBiYXNlLTM2IHN0cmluZyBhbmQgdGhlbiBleHRyYWN0cyAxNiBkaWdpdHNcclxuICAgIGNvbnN0IHRva2VuU3RyaW5nID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic2J0cmluZygyLDE3KTtcclxuICAgIGNvbnN0IHRva2VuSWQgPSBgJHt0aW1lc3RhbXB9XyR7dG9rZW5TdHJpbmd9YDtcclxuICAgIFxyXG4gICAgY29uc3QganNvbkRhdGEgPSBnZXRUb2tlbkRhdGEoKTtcclxuXHJcbiAgICBqc29uRGF0YS5wdXNoKHtcclxuICAgICAgICB0b2tlbklkOiB0b2tlbklkLFxyXG4gICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcclxuICAgICAgICBleHBpcmF0aW9uOiBleHBpcmF0aW9uXHJcbiAgICB9KVxyXG5cclxuICAgIHNldFRva2VuRGF0YShqc29uRGF0YSk7XHJcblxyXG4gICAgcmV0dXJuIHRva2VuSWQ7XHJcbn1cclxuXHJcbi8vIEF1dGhlbnRpY2F0ZXMgdGhhdCBhIHRva2VuIGlzIHZhbGlkLCByZXR1cm5zIGEgYm9vbGVhbiB2YWx1ZSArIGNvcnJlc3BvbmRpbmcgdXNlclxyXG5mdW5jdGlvbiB0b2tlbklzVmFsaWQodG9rZW5JZCkge1xyXG4gICAgY29uc3QganNvbkRhdGEgPSBnZXRUb2tlbkRhdGEoKTtcclxuICAgIGNvbnN0IHRva2VuID0ganNvbkRhdGEuZmluZCh0b2tlbiA9PiB0b2tlbi50b2tlbklkID09PSB0b2tlbklkKTtcclxuXHJcbiAgICAvLyBDb3VsZCBub3QgZmluZCB0b2tlblxyXG4gICAgaWYgKHRva2VuID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2YWxpZDogZmFsc2VcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRva2VuIGhhcyBleHBpcmVkXHJcbiAgICBpZiAodG9rZW4uZXhwaXJhdGlvbiA8IERhdGUubm93KCkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2YWxpZDogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB2YWxpZDogdHJ1ZSxcclxuICAgICAgICB1c2VybmFtZTogdG9rZW4udXNlcmVuYW1lXHJcbiAgICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0geyBnZW5lcmF0ZVRva2VuLCB0b2tlbklzVmFsaWQgfTsiXSwibWFwcGluZ3MiOiI4bkZBZVk7QUFBQUEsYUFBQSxTQUFBQSxDQUFBLFNBQUFDLGNBQUEsV0FBQUEsY0FBQSxFQUFBRCxhQUFBLEdBZlosS0FBTSxDQUFBRSxLQUFLLEVBQUFGLGFBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsWUFBWSxDQUFDLEVBRW5DLEtBQU0sQ0FBQUMsVUFBVSxFQUFBTCxhQUFBLEdBQUFHLENBQUEsTUFBRyxFQUFFLENBQUcsRUFBRSxDQUFHLEVBQUUsQ0FBRyxJQUFJLEVBRXRDO0FBQ0EsUUFBUyxDQUFBRyxhQUFhQSxDQUFDQyxRQUFRLENBQUUsQ0FBQVAsYUFBQSxHQUFBUSxDQUFBLE1BQzdCLEtBQU0sQ0FBQUMsU0FBUyxFQUFBVCxhQUFBLEdBQUFHLENBQUEsTUFBR08sSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQyxFQUM1QjtBQUNBLEtBQU0sQ0FBQUMsVUFBVSxFQUFBWixhQUFBLEdBQUFHLENBQUEsTUFBR00sU0FBUyxDQUFHSixVQUFVLEVBQ3pDO0FBQ0EsS0FBTSxDQUFBUSxXQUFXLEVBQUFiLGFBQUEsR0FBQUcsQ0FBQSxNQUFHVyxJQUFJLENBQUNDLE1BQU0sQ0FBQyxDQUFDLENBQUNDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQ0MsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFDL0QsS0FBTSxDQUFBQyxPQUFPLEVBQUFsQixhQUFBLEdBQUFHLENBQUEsTUFBSSxHQUFFTSxTQUFVLElBQUdJLFdBQVksRUFBQyxFQUU3QyxLQUFNLENBQUFNLFFBQVEsRUFBQW5CLGFBQUEsR0FBQUcsQ0FBQSxNQUFHaUIsWUFBWSxDQUFDLENBQUMsRUFBQ3BCLGFBQUEsR0FBQUcsQ0FBQSxNQUVoQ2dCLFFBQVEsQ0FBQ0UsSUFBSSxDQUFDLENBQ1ZILE9BQU8sQ0FBRUEsT0FBTyxDQUNoQlgsUUFBUSxDQUFFQSxRQUFRLENBQ2xCSyxVQUFVLENBQUVBLFVBQ2hCLENBQUMsQ0FBQyxDQUFBWixhQUFBLEdBQUFHLENBQUEsTUFFRm1CLFlBQVksQ0FBQ0gsUUFBUSxDQUFDLENBQUNuQixhQUFBLEdBQUFHLENBQUEsTUFFdkIsTUFBTyxDQUFBZSxPQUFPLENBQ2xCLENBRUE7QUFDQSxRQUFTLENBQUFLLFlBQVlBLENBQUNMLE9BQU8sQ0FBRSxDQUFBbEIsYUFBQSxHQUFBUSxDQUFBLE1BQzNCLEtBQU0sQ0FBQVcsUUFBUSxFQUFBbkIsYUFBQSxHQUFBRyxDQUFBLE9BQUdpQixZQUFZLENBQUMsQ0FBQyxFQUMvQixLQUFNLENBQUFJLEtBQUssRUFBQXhCLGFBQUEsR0FBQUcsQ0FBQSxPQUFHZ0IsUUFBUSxDQUFDTSxJQUFJLENBQUNELEtBQUssRUFBSSxDQUFBeEIsYUFBQSxHQUFBUSxDQUFBLE1BQUFSLGFBQUEsR0FBQUcsQ0FBQSxjQUFBcUIsS0FBSyxDQUFDTixPQUFPLEdBQUtBLE9BQU8sQ0FBRCxDQUFDLENBQUMsRUFFL0Q7QUFBQWxCLGFBQUEsR0FBQUcsQ0FBQSxPQUNBLEdBQUlxQixLQUFLLEdBQUtFLFNBQVMsQ0FBRSxDQUFBMUIsYUFBQSxHQUFBMkIsQ0FBQSxTQUFBM0IsYUFBQSxHQUFBRyxDQUFBLE9BQ3JCLE1BQU8sQ0FDSHlCLEtBQUssQ0FBRSxLQUNYLENBQUMsQ0FDTCxDQUFDLEtBQUE1QixhQUFBLEdBQUEyQixDQUFBLFVBRUQ7QUFBQTNCLGFBQUEsR0FBQUcsQ0FBQSxPQUNBLEdBQUlxQixLQUFLLENBQUNaLFVBQVUsQ0FBR0YsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQyxDQUFFLENBQUFYLGFBQUEsR0FBQTJCLENBQUEsU0FBQTNCLGFBQUEsR0FBQUcsQ0FBQSxPQUMvQixNQUFPLENBQ0h5QixLQUFLLENBQUUsS0FDWCxDQUFDLENBQ0wsQ0FBQyxLQUFBNUIsYUFBQSxHQUFBMkIsQ0FBQSxVQUFBM0IsYUFBQSxHQUFBRyxDQUFBLE9BRUQsTUFBTyxDQUNIeUIsS0FBSyxDQUFFLElBQUksQ0FDWHJCLFFBQVEsQ0FBRWlCLEtBQUssQ0FBQ0ssU0FDcEIsQ0FBQyxDQUNMLENBQUM3QixhQUFBLEdBQUFHLENBQUEsT0FFRDJCLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHLENBQUV6QixhQUFhLENBQUVpQixZQUFhLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=