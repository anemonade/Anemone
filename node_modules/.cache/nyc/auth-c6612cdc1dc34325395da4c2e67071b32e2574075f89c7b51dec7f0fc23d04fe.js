function cov_n3rxzid55(){var path="C:\\Users\\Ronald\\Desktop\\UNSW\\Y2T1\\SENG2021\\Anemone\\src\\main\\server\\auth.js";var hash="4d38d270095e09bf94ac231f398586b1a904f5bb";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Ronald\\Desktop\\UNSW\\Y2T1\\SENG2021\\Anemone\\src\\main\\server\\auth.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:35}},"1":{start:{line:4,column:19},end:{line:4,column:38}},"2":{start:{line:8,column:22},end:{line:8,column:32}},"3":{start:{line:10,column:21},end:{line:10,column:43}},"4":{start:{line:12,column:22},end:{line:12,column:64}},"5":{start:{line:13,column:18},end:{line:13,column:47}},"6":{start:{line:15,column:19},end:{line:15,column:39}},"7":{start:{line:17,column:4},end:{line:21,column:7}},"8":{start:{line:23,column:4},end:{line:23,column:33}},"9":{start:{line:25,column:4},end:{line:25,column:19}},"10":{start:{line:30,column:21},end:{line:30,column:41}},"11":{start:{line:31,column:16},end:{line:31,column:65}},"12":{start:{line:31,column:39},end:{line:31,column:64}},"13":{start:{line:34,column:4},end:{line:38,column:5}},"14":{start:{line:35,column:8},end:{line:37,column:10}},"15":{start:{line:41,column:4},end:{line:45,column:5}},"16":{start:{line:42,column:8},end:{line:44,column:10}},"17":{start:{line:47,column:4},end:{line:50,column:6}},"18":{start:{line:53,column:0},end:{line:53,column:49}}},fnMap:{"0":{name:"generateToken",decl:{start:{line:7,column:9},end:{line:7,column:22}},loc:{start:{line:7,column:33},end:{line:26,column:1}},line:7},"1":{name:"tokenIsValid",decl:{start:{line:29,column:9},end:{line:29,column:21}},loc:{start:{line:29,column:31},end:{line:51,column:1}},line:29},"2":{name:"(anonymous_2)",decl:{start:{line:31,column:30},end:{line:31,column:31}},loc:{start:{line:31,column:39},end:{line:31,column:64}},line:31}},branchMap:{"0":{loc:{start:{line:34,column:4},end:{line:38,column:5}},type:"if",locations:[{start:{line:34,column:4},end:{line:38,column:5}},{start:{line:34,column:4},end:{line:38,column:5}}],line:34},"1":{loc:{start:{line:41,column:4},end:{line:45,column:5}},type:"if",locations:[{start:{line:41,column:4},end:{line:45,column:5}},{start:{line:41,column:4},end:{line:45,column:5}}],line:41}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"4d38d270095e09bf94ac231f398586b1a904f5bb"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_n3rxzid55=function(){return actualCoverage;};}return actualCoverage;}cov_n3rxzid55();const other=(cov_n3rxzid55().s[0]++,require("./other.js"));// Constants
const ONE_DAY_MS=(cov_n3rxzid55().s[1]++,24*60*60*1000);// Generate a unique token wtih expiration time and adds it to the valid tokens list
function generateToken(username){cov_n3rxzid55().f[0]++;const timestamp=(cov_n3rxzid55().s[2]++,Date.now()),// Expiration time of 1 day from now
expiration=(cov_n3rxzid55().s[3]++,timestamp+ONE_DAY_MS),// Generates a base-36 string and then extracts 16 digits
tokenString=(cov_n3rxzid55().s[4]++,Math.random().toString(36).substring(2,17)),tokenId=(cov_n3rxzid55().s[5]++,`${timestamp}_${tokenString}`),jsonData=(cov_n3rxzid55().s[6]++,other.getTokenData());cov_n3rxzid55().s[7]++;jsonData.push({tokenId,username,expiration});cov_n3rxzid55().s[8]++;other.setTokenData(jsonData);cov_n3rxzid55().s[9]++;return tokenId;}// Authenticates that a token is valid, returns a boolean value + corresponding user
function tokenIsValid(tokenId){cov_n3rxzid55().f[1]++;const jsonData=(cov_n3rxzid55().s[10]++,other.getTokenData()),token=(cov_n3rxzid55().s[11]++,jsonData.find(token=>{cov_n3rxzid55().f[2]++;cov_n3rxzid55().s[12]++;return token.tokenId===tokenId;}));// Could not find token
cov_n3rxzid55().s[13]++;if(token===undefined){cov_n3rxzid55().b[0][0]++;cov_n3rxzid55().s[14]++;return{valid:false};}else{cov_n3rxzid55().b[0][1]++;}// Token has expired
cov_n3rxzid55().s[15]++;if(token.expiration<Date.now()){cov_n3rxzid55().b[1][0]++;cov_n3rxzid55().s[16]++;return{valid:false};}else{cov_n3rxzid55().b[1][1]++;}cov_n3rxzid55().s[17]++;return{valid:true,username:token.username};}cov_n3rxzid55().s[18]++;module.exports={generateToken,tokenIsValid};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfbjNyeHppZDU1IiwiYWN0dWFsQ292ZXJhZ2UiLCJvdGhlciIsInMiLCJyZXF1aXJlIiwiT05FX0RBWV9NUyIsImdlbmVyYXRlVG9rZW4iLCJ1c2VybmFtZSIsImYiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiZXhwaXJhdGlvbiIsInRva2VuU3RyaW5nIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwidG9rZW5JZCIsImpzb25EYXRhIiwiZ2V0VG9rZW5EYXRhIiwicHVzaCIsInNldFRva2VuRGF0YSIsInRva2VuSXNWYWxpZCIsInRva2VuIiwiZmluZCIsInVuZGVmaW5lZCIsImIiLCJ2YWxpZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJhdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG90aGVyID0gcmVxdWlyZShcIi4vb3RoZXIuanNcIik7XHJcblxyXG4vLyBDb25zdGFudHNcclxuY29uc3QgT05FX0RBWV9NUyA9IDI0ICogNjAgKiA2MCAqIDEwMDA7XHJcblxyXG4vLyBHZW5lcmF0ZSBhIHVuaXF1ZSB0b2tlbiB3dGloIGV4cGlyYXRpb24gdGltZSBhbmQgYWRkcyBpdCB0byB0aGUgdmFsaWQgdG9rZW5zIGxpc3RcclxuZnVuY3Rpb24gZ2VuZXJhdGVUb2tlbih1c2VybmFtZSkge1xyXG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKSxcclxuICAgICAgICAvLyBFeHBpcmF0aW9uIHRpbWUgb2YgMSBkYXkgZnJvbSBub3dcclxuICAgICAgICBleHBpcmF0aW9uID0gdGltZXN0YW1wICsgT05FX0RBWV9NUyxcclxuICAgICAgICAvLyBHZW5lcmF0ZXMgYSBiYXNlLTM2IHN0cmluZyBhbmQgdGhlbiBleHRyYWN0cyAxNiBkaWdpdHNcclxuICAgICAgICB0b2tlblN0cmluZyA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLDE3KSxcclxuICAgICAgICB0b2tlbklkID0gYCR7dGltZXN0YW1wfV8ke3Rva2VuU3RyaW5nfWAsXHJcblxyXG4gICAgICAgIGpzb25EYXRhID0gb3RoZXIuZ2V0VG9rZW5EYXRhKCk7XHJcblxyXG4gICAganNvbkRhdGEucHVzaCh7XHJcbiAgICAgICAgdG9rZW5JZCxcclxuICAgICAgICB1c2VybmFtZSxcclxuICAgICAgICBleHBpcmF0aW9uXHJcbiAgICB9KTtcclxuXHJcbiAgICBvdGhlci5zZXRUb2tlbkRhdGEoanNvbkRhdGEpO1xyXG5cclxuICAgIHJldHVybiB0b2tlbklkO1xyXG59XHJcblxyXG4vLyBBdXRoZW50aWNhdGVzIHRoYXQgYSB0b2tlbiBpcyB2YWxpZCwgcmV0dXJucyBhIGJvb2xlYW4gdmFsdWUgKyBjb3JyZXNwb25kaW5nIHVzZXJcclxuZnVuY3Rpb24gdG9rZW5Jc1ZhbGlkKHRva2VuSWQpIHtcclxuICAgIGNvbnN0IGpzb25EYXRhID0gb3RoZXIuZ2V0VG9rZW5EYXRhKCksXHJcbiAgICAgICAgdG9rZW4gPSBqc29uRGF0YS5maW5kKHRva2VuID0+IHRva2VuLnRva2VuSWQgPT09IHRva2VuSWQpO1xyXG5cclxuICAgIC8vIENvdWxkIG5vdCBmaW5kIHRva2VuXHJcbiAgICBpZiAodG9rZW4gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZhbGlkOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVG9rZW4gaGFzIGV4cGlyZWRcclxuICAgIGlmICh0b2tlbi5leHBpcmF0aW9uIDwgRGF0ZS5ub3coKSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZhbGlkOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB2YWxpZDogdHJ1ZSxcclxuICAgICAgICB1c2VybmFtZTogdG9rZW4udXNlcm5hbWVcclxuICAgIH07XHJcbn1cclxuXHJcbm1vZHVs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